<?xml version="1.0" encoding="UTF-8"?>
<c:model
    xmlns:c="urn:webdetails/com/2012"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="urn:webdetails/com/2012 ../../schema/com_2012.xsd"
    xmlns="http://www.w3.org/1999/xhtml">

    <c:complexType name="BarChartCommon"
                   space="pvc.options.charts"
                   base="pvc.options.charts.CategoricalNumericChart"
                   abstract="true">
        <c:documentation>
            The common options documentation class of the <b>Bar family</b> charts.
        </c:documentation>

        <c:property name="categoryRole" type="string pvc.options.VisualRole" category="Chart > Visual Roles">
            <c:documentation>
                The <tt>category</tt> visual role is a plot-level visual role that
                represents a generic <i>logical grouping</i> of the data points
                and is visually encoded by grouping bars in
                separate bands along the <i>base</i> axis.

                This is a shortcut property for the main plot's
                <c:link to="pvc.options.visualRoles.BarPlotCommonVisualRoles#category" />.
            </c:documentation>
        </c:property>

        <c:property name="valueRole" type="string pvc.options.VisualRole" category="Chart > Visual Roles">
            <c:documentation>
                The <tt>value</tt> visual role is a plot-level visual role that
                represents its main measure, specifically,
                it is visually encoded by the <i>orthogonal</i> height of bars.

                This is a shortcut property for the main plot's
                <c:link to="pvc.options.visualRoles.BarPlotCommonVisualRoles#value" />.
            </c:documentation>
        </c:property>

        <c:property name="baseAxis" type="pvc.options.axes.FlattenedDiscreteCartesianAxis" category="Axes">
            <c:documentation>
                The base cartesian axis panel options.

                When the chart <c:link to="pvc.options.charts.BasicChart#orientation" />
                is <tt>vertical</tt> the base axis is laid out horizontally.

                See <c:link to="pvc.options.axes.CartesianAxis" />
                to know the additional names by which a cartesian axis can be referred to.
            </c:documentation>
        </c:property>

        <c:property name="panelSizeRatio" type="number" default="0.9" category="Chart > Layout">
            <c:documentation>
             Percentage of occupied space over total space
             in a discrete axis band.

             The remaining space will be of
             margins between bands.
            </c:documentation>
        </c:property>
    </c:complexType>

    <c:complexType name="BarPlotCommon"
                   space="pvc.options.plots"
                   base="pvc.options.plots.CategoricalNumericPlot"
                   facets="pvc.options.plots.ValuesOverflowPlotFacet"
                   abstract="true"
                   use="expanded">
        <c:documentation>
            The common options documentation class of the <b>Bar family</b> plots.
        </c:documentation>

        <c:property name="visualRoles"
                    type="map(string : pvc.options.VisualRole) pvc.options.visualRoles.BarPlotCommonVisualRoles"
                    category="Visual Roles">
            <c:documentation>
                The plot's visual roles map.

                See <c:link to="pvc.options.plots.BasicPlot#visualRoles" /> for more information.
            </c:documentation>
        </c:property>

        <c:property name="valuesAnchor" type="pvc.options.varia.MarkAnchor" default="'center'" category="Style">
            <c:documentation>
                The alignment of a value label
                relative to its corresponding visual element position.
            </c:documentation>
        </c:property>

        <c:property name="valuesMask" type="string" default="'{value}'" category="Layout">
            <c:documentation>
                The values mask used to build the text of value labels.

                The mask may contain scene variable names and/or scene atom names,
                like in the examples:
                <ul>
                    <li>scene variables: <tt>{category}: {value} EUR</tt>, could yield <tt>Drinks: 3.45 EUR</tt></li>
                    <li>atom variables:  <tt>{#family} - {#product}</tt>, could yield <tt>Plains - Boeing 747</tt></li>
                </ul>
            </c:documentation>
        </c:property>

        <c:property name="valuesOptimizeLegibility" type="boolean" default="false" category="Style">
            <c:documentation>
                Indicates if legibility of value labels should be optimized.

                The current algorithm varies the text color so that it has enough contrast
                for the fill color of the associated bar.

                It is applied only when a value label is considered to be <i>inside</i> its
                associated bar. Presently, it is considered to be inside, if the center point
                of the label is within the bounds of the bar.
            </c:documentation>
        </c:property>

        <!-- Facet Override -->
        <c:property name="valuesOverflow" type="pvc.options.varia.ValuesOverflow" category="Style" 
            default="'hide'">
            <c:documentation>
                The behavior to apply when the text of a value label does not fit within the bounds of its associated bar.

                This option applies only when <c:link to="pvc.options.plots.Plot#valuesVisible" /> is true.

                Moreover, it also applies only for certain configurations of value label placement,
                relative to the associated bar. Presently, the supported placements are:
                <ul>
                    <li><b>non-negative text margin</b>, 
                        <c:link to="pvc.options.marks.LabelExtensionPoint#textMargin" />.
                    </li>
                    <li><b>horizontal text</b> — on horizontal or vertical bars; 
                        on vertical bars, text is allowed to overflow, without trimming.
                        Text is horizontal when
                        <c:link to="pvc.options.marks.LabelExtensionPoint#textAngle" /> 
                        is such that <tt>sin(textAngle) = 0</tt> (example: <tt>0</tt>).
                    </li>
                    <li><b>vertical text on vertical bars</b> — 
                        text is vertical when
                        <c:link to="pvc.options.marks.LabelExtensionPoint#textAngle" /> 
                        is such that <tt>cos(textAngle) = 0</tt> (example: <tt>Math.PI/2</tt>, <tt>-Math.PI/2</tt>, <tt>3*Math.PI/2</tt>, ...).
                    </li>
                    <li><b>text that is intensionally inside the bar</b> — 
                        this would be too painful to enumerate;
                        generally, it depends on the values of 
                        <c:link to="pvc.options.plots.Plot#valuesAnchor" />,
                        <c:link to="pvc.options.marks.LabelExtensionPoint#textAngle" />,
                        <c:link to="pvc.options.marks.LabelExtensionPoint#textAlign" /> and
                        <c:link to="pvc.options.marks.LabelExtensionPoint#textBaseline" />.
                    </li>
                </ul>

                When an unsupported placement occurs, the label is shown.

                Note that for the purposes of hiding and trimming, 
                the value of <c:link to="pvc.options.marks.LabelExtensionPoint#textMargin" />
                is used for more that the distance between the anchor points of the label and the bar.
                
                It is also included as a required margin at the side opposite to the label's anchor.
                For example, if a label is anchored with a <tt>bottom</tt> <i>textBaseline</i>, 
                the text margin must also be available on the top side of the label.
                
                Also, the same margin is respected on the horizontal sides of the label (left and right), 
                whether or not they are anchor sides.
            </c:documentation>
        </c:property>

        <c:property name="barSizeRatio" type="number" default="0.9" category="Style">
            <c:documentation>
                The percentage of the grouped bar width
                versus the space between grouped bars (does not apply to stacked bars).

                A number between <tt>0.05</tt> and <tt>1</tt>.
            </c:documentation>
        </c:property>

        <c:property name="barSizeMax" type="number" default="2000" category="Style">
            <c:documentation>
                The maximum width of a bar, in pixel units.

                A number not less than <tt>1</tt>, possibly infinity.
            </c:documentation>
        </c:property>

        <c:property name="barOrthoSizeMin" type="number" default="1.5" category="Style">
            <c:documentation>
                The minimum height of a non-null valued bar, in pixel units.

                If you want that null-valued bars also show up, as zero bars do,
                consider using a
                <c:link to="pvc.options.varia.NullInterpolationMode#Zero" />
                <c:link to="#nullInterpolationMode" />.

                If you do not want to show zero-valued bars, then set this option to zero.

                A finite number, not less than <tt>0</tt>.
            </c:documentation>
        </c:property>

        <c:property name="maxBarSize" type="number" default="2000" category="Style">
            <c:documentation>
                <c:deprecated>Use <c:link to="#barSizeMax" /> instead.</c:deprecated>
                The maximum width of a bar, in pixel units.
            </c:documentation>
        </c:property>

        <c:property name="barStackedMargin" type="number" default="0" category="Style">
            <c:documentation>
                The space between bars of a given stack, in pixel units
                (applies to stacked bars).

                A non-negative number.
            </c:documentation>
        </c:property>

        <c:property name="overflowMarkersVisible" type="boolean" default="true" category="Style">
            <c:documentation>
                Indicates if overflow and underflow markers are shown
                when the bars are drawn off the plot area.

                Bars can be drawn off the plot area by use of the
                continuous axis properties <tt>fixedMin</tt> and <tt>fixedMax</tt>.
            </c:documentation>
        </c:property>

        <c:property name="extensionPoints" type="pvc.options.ext.BarPlotCommonExtensionPoints" category="Style" expandUse="optional">
            <c:documentation>
                The extension points object contains style definitions for
                the marks of the plot.
            </c:documentation>
        </c:property>
    </c:complexType>

    <c:complexType name="BarPlotCommonExtensionPoints"
                   space="pvc.options.ext"
                   use="expanded">
        <c:documentation>
            The extension points of the <i>bar family</i> plot types.

            Plot extension points can be specified:
            <ul>
                <li>at the plot level, in the <i>extensionPoints</i> property,
                    without need to prefix the extension point with the
                    plot id or name.
                </li>
                <li>at the plot options level, directly,
                    without need to prefix the extension point with the
                    plot id or name.
                </li>
                <li>
                    if it is an internal plot (<i>main</i>, <i>plot2</i> or <i>trend</i>),
                    at the chart options level, directly.
                </li>
            </ul>

            To use an extension point you must find its full name, by joining:
            <ol>
                <li>plot property name (ex: <tt>bar</tt>)</li>
                <li>extension property (ex: <tt>panel</tt>)</li>
                <li>the "_" character</li>
                <li>extension sub-property (ex: <tt>strokeStyle</tt>)</li>
            </ol>
            and obtaining, for the examples, the camel-cased name: <tt>barPanel_strokeStyle</tt>
            (see <c:link to="http://en.wikipedia.org/wiki/CamelCase" />).

            The extension points of the <i>main plot</i> of a chart
            may be used without the plot property name prefix.
            In the example, when the <tt>bar</tt> plot is the main plot,
            the extension point can be written as <tt>panel_strokeStyle</tt>.
        </c:documentation>

        <c:property name="panel" type="pvc.options.marks.PanelExtensionPoint">
            <c:documentation>
                The extension point of the series panel of the bar plot.
            </c:documentation>
        </c:property>

        <c:property name="_" type="pvc.options.marks.BarExtensionPoint">
            <c:documentation>
                The extension point of the bar mark.

                This extension point can only be used by prefixing it
                with the property name of the plot.

                So, supposing this plot is under a property named <tt>bar</tt>,
                and it is desired to access the <tt>strokeStyle</tt> property of the bar mark,
                the full name of the extension property
                would be <tt>bar_strokeStyle</tt>.
            </c:documentation>
        </c:property>

        <c:property name="label" type="pvc.options.marks.LabelExtensionPoint">
            <c:documentation>
                The extension point of the value label mark.
            </c:documentation>
        </c:property>

        <c:property name="underflowMarker" type="pvc.options.marks.DotExtensionPoint">
            <c:documentation>
                The extension point of the underflow marker.
            </c:documentation>
        </c:property>

        <c:property name="overflowMarker" type="pvc.options.marks.DotExtensionPoint">
            <c:documentation>
                The extension point of the overflow marker.
            </c:documentation>
        </c:property>
    </c:complexType>

    <c:complexType name="BarPlotCommonVisualRoles"
                   space="pvc.options.visualRoles"
                   base="pvc.options.visualRoles.CategoricalPlotVisualRoles"
                   use="literal">
        <c:documentation>
            The visual roles options class of the <i>bar family</i> plot types.
        </c:documentation>

        <c:property name="category" type="string pvc.options.VisualRole" category="Visual Roles">
            <c:documentation>
                The <tt>category</tt> visual role is a plot-level visual role that
                represents a generic <i>logical grouping</i> of the data points
                and is visually encoded by grouping bars in
                separate bands along the <i>base</i> axis.

                On the bar family charts it is restricted to be discrete.

                For additional information,
                see the base version of this property:
                <c:link to="pvc.options.visualRoles.CategoricalPlotVisualRoles#category" />.
            </c:documentation>
        </c:property>

        <c:property name="value" type="string pvc.options.VisualRole" category="Visual Roles">
            <c:documentation>
                The <tt>value</tt> visual role is a plot-level visual role that
                represents its main measure, specifically,
                it is visually encoded by the <i>orthogonal</i> height of bars.

                The <tt>value</tt> visual role automatically binds to
                a single numeric dimension whose name has the <tt>value</tt> prefix.

                The <tt>value</tt> visual role is required.

                See <c:link to="pvc.options.VisualRole" />
                for more information on supported data types.
            </c:documentation>
        </c:property>

    </c:complexType>
</c:model>